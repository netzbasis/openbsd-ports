$OpenBSD: patch-bin_activemq,v 1.7 2015/08/19 07:22:55 jasper Exp $
--- bin/activemq.orig	Mon Aug 10 17:26:28 2015
+++ bin/activemq	Sat Aug 15 10:06:24 2015
@@ -152,10 +152,10 @@ fi
 # For using instances
 if ( basename $0 | grep "activemq-instance-" > /dev/null);then
   INST="`basename $0|sed 's/^activemq-instance-//;s/\.sh$//'`"
-  ACTIVEMQ_CONFIGS="/etc/default/activemq-instance-${INST} $HOME/.activemqrc-instance-${INST}"
+  ACTIVEMQ_CONFIGS="${SYSCONFDIR}/activemq-instance-${INST} $HOME/.activemqrc-instance-${INST}"
   echo "INFO: Using alternative activemq configuration files: $ACTIVEMQ_CONFIGS"
 else
-  ACTIVEMQ_CONFIGS="/etc/default/activemq $HOME/.activemqrc $ACTIVEMQ_HOME/bin/env"
+  ACTIVEMQ_CONFIGS="${SYSCONFDIR}/activemq.conf $HOME/.activemqrc $ACTIVEMQ_HOME/bin/env"
 fi
 
 # load activemq configuration
@@ -539,7 +539,6 @@ invoke_stop(){
          echo
          echo "INFO: Regular shutdown not successful,  sending SIGKILL to process"
          invoke_kill
-         RET="$?"
        fi
     elif [ -f "$ACTIVEMQ_PIDFILE" ];then
        echo "ERROR: No or outdated process id in '$ACTIVEMQ_PIDFILE'"
@@ -616,7 +615,7 @@ Configuration of this script:
     Modify $ACTIVEMQ_BASE/bin/env or create a copy of that file on a suitable location.
     To use additional configurations for running multiple instances on the same operating system
     rename or symlink script to a name matching to activemq-instance-<INSTANCENAME>.
-    This changes the configuration location to /etc/default/activemq-instance-<INSTANCENAME> and
+    This changes the configuration location to ${SYSCONFDIR}/activemq-instance-<INSTANCENAME> and
     \$HOME/.activemqrc-instance-<INSTANCENAME>.
 EOF
   exit 1
@@ -649,7 +648,7 @@ case "$1" in
     invoke_console
     exit $?
     ;;
-  stop)
+esac
     invoke_stop 
     exit $?
     ;;
@@ -690,4 +689,4 @@ case "$1" in
   *)
     invoke_task checkforrunning
     exit $?
-esac
\ No newline at end of file
+esac
