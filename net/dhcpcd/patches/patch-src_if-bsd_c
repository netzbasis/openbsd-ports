$OpenBSD: patch-src_if-bsd_c,v 1.4 2018/04/16 11:35:27 sthen Exp $

From 346107481553888ddc9d60ad028b57423c59bb2e Mon Sep 17 00:00:00 2001
From: Roy Marples <roy@marples.name>
Date: Sun, 15 Apr 2018 14:23:49 +0100
Subject: OpenBSD: Fix adding INET6 on-link routes without an address

Index: src/if-bsd.c
--- src/if-bsd.c.orig
+++ src/if-bsd.c
@@ -502,7 +502,8 @@ if_route(unsigned char cmd, const struct rt *rt)
 		if (!(rtm->rtm_flags & RTF_REJECT) &&
 		    !sa_is_loopback(&rt->rt_gateway))
 		{
-			rtm->rtm_addrs |= RTA_IFP;
+			if (!gateway_unspec)
+				rtm->rtm_addrs |= RTA_IFP;
 			if (!sa_is_unspecified(&rt->rt_ifa))
 				rtm->rtm_addrs |= RTA_IFA;
 		}
