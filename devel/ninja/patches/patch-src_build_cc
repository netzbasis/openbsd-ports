$OpenBSD: patch-src_build_cc,v 1.1 2019/12/20 15:51:26 kurt Exp $

Use a deque for the ready_ queue so that build order is not randomized
by using a set of pointers.

Index: src/build.cc
--- src/build.cc.orig
+++ src/build.cc
@@ -348,9 +348,8 @@ bool Plan::AddSubTarget(Node* node, Node* dependent, s
 Edge* Plan::FindWork() {
   if (ready_.empty())
     return NULL;
-  set<Edge*>::iterator e = ready_.begin();
-  Edge* edge = *e;
-  ready_.erase(e);
+  Edge* edge = ready_.front();
+  ready_.pop_front();
   return edge;
 }
 
@@ -372,7 +371,7 @@ void Plan::ScheduleWork(map<Edge*, Want>::iterator wan
     pool->RetrieveReadyEdges(&ready_);
   } else {
     pool->EdgeScheduled(*edge);
-    ready_.insert(edge);
+    ready_.push_back(edge);
   }
 }
 
