$OpenBSD: patch-plat_rockchip_rk3399_drivers_soc_soc_c,v 1.1 2020/01/07 07:01:56 jsg Exp $

https://github.com/armbian/build/raw/master/patch/atf/atf-rk3399/switch-power-domains-on-before-reset.patch

Index: plat/rockchip/rk3399/drivers/soc/soc.c
--- plat/rockchip/rk3399/drivers/soc/soc.c.orig
+++ plat/rockchip/rk3399/drivers/soc/soc.c
@@ -17,6 +17,7 @@
 #include <dram.h>
 #include <m0_ctl.h>
 #include <plat_private.h>
+#include <pmu.h>
 #include <rk3399_def.h>
 #include <secure.h>
 #include <soc.h>
@@ -327,6 +328,7 @@ void soc_global_soft_reset_init(void)
 
 void __dead2 soc_global_soft_reset(void)
 {
+	pmu_power_domains_on();
 	set_pll_slow_mode(VPLL_ID);
 	set_pll_slow_mode(NPLL_ID);
 	set_pll_slow_mode(GPLL_ID);
