$OpenBSD: patch-modules_daala_decode_c,v 1.2 2016/01/12 09:22:07 czarkoff Exp $
--- modules/daala/decode.c.orig	Tue Dec  1 13:09:48 2015
+++ modules/daala/decode.c	Thu Jan  7 18:57:18 2016
@@ -150,9 +150,15 @@ int daala_decode(struct viddec_state *vds, struct vidf
 			return EPROTO;
 		}
 
-		r = daala_decode_packet_in(vds->dec, &img, &dp);
+		r = daala_decode_packet_in(vds->dec, &dp);
 		if (r < 0) {
 			warning("daala: decode: packet_in error (%d)\n", r);
+			return EPROTO;
+		}
+
+		r = daala_decode_img_out(vds->dec, &img);
+		if (r != 1) {
+			warning("daala: decode: img_out error (%d)\n", r);
 			return EPROTO;
 		}
 
