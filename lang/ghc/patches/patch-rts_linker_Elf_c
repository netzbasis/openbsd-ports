$OpenBSD: patch-rts_linker_Elf_c,v 1.1 2018/01/22 00:42:30 kili Exp $

Index: rts/linker/Elf.c
--- rts/linker/Elf.c.orig
+++ rts/linker/Elf.c
@@ -91,6 +91,13 @@
 #  include <machine/reloc.h>
 #  define R_386_32    RELOC_32
 #  define R_386_PC32  RELOC_PC32
+/* Crude hack alert!
+ * When SHN_XINDEX is defined, this code als assumes the existance of
+ * SHT_SYMTAB_SHNDX. which doesn't exist at the moment on OpenBSD.
+ */
+#  ifdef SHN_XINDEX
+#    undef SHN_XINDEX
+#  endif
 #endif
 
 /* If elf.h doesn't define it */
