$OpenBSD: patch-lib_ruby_stdlib_rubygems_commands_query_command_rb,v 1.1 2017/09/02 21:36:55 jeremy Exp $

Index: lib/ruby/stdlib/rubygems/commands/query_command.rb
--- lib/ruby/stdlib/rubygems/commands/query_command.rb.orig
+++ lib/ruby/stdlib/rubygems/commands/query_command.rb
@@ -226,7 +226,7 @@ is too hard to use.
         end
       end
 
-      output << make_entry(matching_tuples, platforms)
+      output << clean_text(make_entry(matching_tuples, platforms))
     end
   end
 
@@ -352,7 +352,8 @@ is too hard to use.
   end
 
   def spec_summary entry, spec
-    entry << "\n\n" << format_text(spec.summary, 68, 4)
+    summary = truncate_text(spec.summary, "the summary for #{spec.full_name}")
+    entry << "\n\n" << format_text(summary, 68, 4)
   end
 
 end
