$OpenBSD: patch-tests_CMakeLists_txt,v 1.1.1.1 2019/03/14 18:33:08 landry Exp $

use ports gtest
cf https://github.com/lutraconsulting/MDAL/issues/95

Index: tests/CMakeLists.txt
--- tests/CMakeLists.txt.orig
+++ tests/CMakeLists.txt
@@ -2,32 +2,12 @@
 # Copyright (C) 2018 Peter Petrik (zilolv at gmail dot com)
 
 FIND_PACKAGE(Threads REQUIRED)
+find_package(GTest REQUIRED)
 
-#########################################################################
-#########################################################################
-#########################################################################
-#########################################################################
-# https://crascit.com/2015/07/25/cmake-gtest/
-
-# Download and unpack googletest at configure time
-FILE(MAKE_DIRECTORY "${CMAKE_BINARY_DIR}/googletest-download")
-CONFIGURE_FILE("${CMAKE_CURRENT_SOURCE_DIR}/GTestCMakeLists.in" "${CMAKE_BINARY_DIR}/googletest-download/CMakeLists.txt")
-EXECUTE_PROCESS(COMMAND "${CMAKE_COMMAND}" -G "${CMAKE_GENERATOR}" .
-    WORKING_DIRECTORY "${CMAKE_BINARY_DIR}/googletest-download" )
-EXECUTE_PROCESS(COMMAND "${CMAKE_COMMAND}" --build .
-    WORKING_DIRECTORY "${CMAKE_BINARY_DIR}/googletest-download" )
-
 # Prevent GoogleTest from overriding our compiler/linker options
 # when building with Visual Studio
 SET(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
 
-# Add googletest directly to our build. This adds
-# the following targets: gtest, gtest_main, gmock
-# and gmock_main
-ADD_SUBDIRECTORY("${CMAKE_BINARY_DIR}/googletest-src"
-                 "${CMAKE_BINARY_DIR}/googletest-build"
-                 EXCLUDE_FROM_ALL)
-
 # The gtest/gmock targets carry header search path
 # dependencies automatically when using CMake 2.8.11 or
 # later. Otherwise we have to add them here ourselves.
@@ -49,6 +29,7 @@ INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/mdal/api)
 INCLUDE_DIRECTORIES(  
   ${CMAKE_CURRENT_SOURCE_DIR}
   ${CMAKE_CURRENT_BINARY_DIR}
+  ${GTEST_INCLUDE_DIR}
   ${CMAKE_BINARY_DIR}/mdal
   ${CMAKE_SOURCE_DIR}/mdal
 )
