$OpenBSD: patch-src_gifread_gifread_c,v 1.1 2017/12/12 15:51:44 fcambus Exp $

Fix for CVE-2017-16938 (Global buffer overflow)
https://sourceforge.net/p/optipng/bugs/69/

Index: src/gifread/gifread.c
--- src/gifread/gifread.c.orig
+++ src/gifread/gifread.c
@@ -499,6 +499,8 @@ static int LZWReadByte(int init_flag, int input_code_s
             *sp++ = table[1][code];
             if (code == table[0][code])
                 GIFError("GIF/LZW error: circular table entry");
+            if ((size_t)(sp - stack) >= sizeof(stack) / sizeof(stack[0]))
+                GIFError("GIF/LZW error: circular table");
             code = table[0][code];
         }
 
