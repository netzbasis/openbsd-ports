$OpenBSD: patch-CMakeLists_txt,v 1.1.1.1 2018/01/12 22:50:45 awolk Exp $

Don't do this hg thing.

Index: CMakeLists.txt
--- CMakeLists.txt.orig
+++ CMakeLists.txt
@@ -16,38 +16,13 @@ OPTION(XNA4_VERTEXTEXTURE "Build MojoShader with XNA4 
 
 INCLUDE_DIRECTORIES(.)
 
-FIND_PROGRAM(HG hg DOC "Path to hg command line app: http://www.selenic.com/mercurial/")
-IF(NOT HG)
-    MESSAGE(STATUS "Mercurial (hg) not found. You can go on, but version info will be wrong.")
-    SET(MOJOSHADER_VERSION -1)
-    SET(MOJOSHADER_CHANGESET "???")
-ELSE(NOT HG)
-    MARK_AS_ADVANCED(HG)
-    EXECUTE_PROCESS(
-        COMMAND hg tip --template {rev}
-        WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}"
-        RESULT_VARIABLE HGVERSION_RC
-        OUTPUT_VARIABLE MOJOSHADER_VERSION
-        ERROR_QUIET
-        OUTPUT_STRIP_TRAILING_WHITESPACE
-    )
-    EXECUTE_PROCESS(
-        COMMAND hg tip --template hg-{rev}:{node|short}
-        WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}"
-        RESULT_VARIABLE HGVERSION_RC
-        OUTPUT_VARIABLE MOJOSHADER_CHANGESET
-        ERROR_QUIET
-        OUTPUT_STRIP_TRAILING_WHITESPACE
-    )
-ENDIF(NOT HG)
-
 WRITE_FILE(
     "${CMAKE_CURRENT_SOURCE_DIR}/mojoshader_version.h"
     "/* This file was autogenerated. Do not edit! */\n"
     "#ifndef _INCL_MOJOSHADER_VERSION_H_\n"
     "#define _INCL_MOJOSHADER_VERSION_H_\n"
-    "#define MOJOSHADER_VERSION ${MOJOSHADER_VERSION}\n"
-    "#define MOJOSHADER_CHANGESET \"${MOJOSHADER_CHANGESET}\"\n"
+    "#define MOJOSHADER_VERSION ${HG_CHANGESET}\n"
+    "#define MOJOSHADER_CHANGESET \"hg-${HG_CHANGESET}:${HG_COMMIT}\"\n"
     "#endif\n"
 )
 
