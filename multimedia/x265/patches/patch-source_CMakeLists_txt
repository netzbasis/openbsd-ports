$OpenBSD: patch-source_CMakeLists_txt,v 1.4 2015/10/01 15:13:36 ajacoutot Exp $

threading: add a slow-path for platforms with no system atomics

--- source/CMakeLists.txt.orig	Thu Oct  1 04:11:47 2015
+++ source/CMakeLists.txt	Thu Oct  1 04:12:30 2015
@@ -82,6 +82,10 @@ if(UNIX)
         endif()
     endif()
     mark_as_advanced(LIBRT NUMA_FOUND)
+    option(NO_ATOMICS "Use a slow mutex to replace atomics" OFF)
+    if(NO_ATOMICS)
+        add_definitions(-DNO_ATOMICS=1)
+    endif(NO_ATOMICS)
 endif(UNIX)
 
 if(X64 AND NOT WIN32)
