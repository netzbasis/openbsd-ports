$OpenBSD: patch-luaa_c,v 1.3 2015/11/09 14:36:12 dcoppa Exp $

commit 821e3e7e2cf1f301f83b790d66452913f92324ef
Author: Uli Schlachter <psychon@znc.in>
Date:   Sat Oct 10 22:25:56 2015 +0200

Make awesome.quit() during startup work

Signed-off-by: Uli Schlachter <psychon@znc.in>

--- luaa.c.orig	Sat Jan 10 20:36:35 2015
+++ luaa.c	Mon Nov  9 13:54:50 2015
@@ -107,6 +107,8 @@ composite_manager_running(void)
 static int
 luaA_quit(lua_State *L)
 {
+    if (globalconf.loop == NULL)
+        globalconf.loop = g_main_loop_new(NULL, FALSE);
     g_main_loop_quit(globalconf.loop);
     return 0;
 }
