$OpenBSD: patch-src_sphere_c,v 1.3 2014/12/29 10:44:55 sthen Exp $

[7d3f38] Check for minimum size sphere headers

--- src/sphere.c.orig	Wed Dec 24 12:31:33 2014
+++ src/sphere.c	Wed Dec 24 12:31:53 2014
@@ -47,6 +47,11 @@ static int start_read(sox_format_t * ft)
 
   /* Determine header size, and allocate a buffer large enough to hold it. */
   sscanf(fldsval, "%lu", &header_size_ul);
+  if (header_size_ul < 16) {
+    lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
+    return (SOX_EOF);
+  }
+
   buf = lsx_malloc(header_size = header_size_ul);
 
   /* Skip what we have read so far */
