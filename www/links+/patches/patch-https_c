$OpenBSD: patch-https_c,v 1.4 2016/09/03 09:33:19 sthen Exp $
--- https.c.orig	Sun Jun 26 18:52:02 2016
+++ https.c	Thu Sep  1 20:15:20 2016
@@ -89,6 +89,11 @@ SSL *getSSL(void)
 					RAND_write_file(cast_const_char f_randfile);
 			}
 		}
+#elif defined(HAVE_RAND_FILE_NAME) && defined(HAVE_RAND_LOAD_FILE) && defined(HAVE_RAND_WRITE_FILE)
+		unsigned char f_randfile[PATH_MAX];
+		const unsigned char *f = (const unsigned char *)RAND_file_name(cast_char f_randfile, sizeof(f_randfile));
+		if (RAND_load_file(cast_const_char f_randfile, -1))
+			RAND_write_file(cast_const_char f_randfile);
 #endif
 
 #if defined(HAVE_RAND_ADD)
