$OpenBSD: patch-dom_crypto_WebCryptoTask_cpp,v 1.1 2020/05/26 14:03:49 landry Exp $

backport https://hg.mozilla.org/mozilla-central/rev/463069687b3d
fixes webrtc w/ nss 3.52
cf https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=246363
cf https://bugzilla.mozilla.org/show_bug.cgi?id=1636632
cf https://bugzilla.mozilla.org/show_bug.cgi?id=1624128

Index: dom/crypto/WebCryptoTask.cpp
--- dom/crypto/WebCryptoTask.cpp.orig
+++ dom/crypto/WebCryptoTask.cpp
@@ -600,6 +600,7 @@ class AesTask : public ReturnArrayBufferViewTask, publ
       case CKM_AES_GCM:
         gcmParams.pIv = mIv.Elements();
         gcmParams.ulIvLen = mIv.Length();
+        gcmParams.ulIvBits = gcmParams.ulIvLen * 8;
         gcmParams.pAAD = mAad.Elements();
         gcmParams.ulAADLen = mAad.Length();
         gcmParams.ulTagBits = mTagLength;
