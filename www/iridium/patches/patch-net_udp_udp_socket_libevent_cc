$OpenBSD: patch-net_udp_udp_socket_libevent_cc,v 1.3 2015/05/26 17:37:40 robert Exp $
--- net/udp/udp_socket_libevent.cc.orig.port	Thu May 14 00:35:47 2015
+++ net/udp/udp_socket_libevent.cc	Wed May 20 08:34:56 2015
@@ -43,7 +43,7 @@ const int kBindRetries = 10;
 const int kPortStart = 1024;
 const int kPortEnd = 65535;
 
-#if defined(OS_MACOSX)
+#if defined(OS_MACOSX) || defined(OS_BSD)
 
 // Returns IPv4 address in network order.
 int GetIPv4AddressFromIndex(int socket, uint32 index, uint32* address){
@@ -630,7 +630,7 @@ int UDPSocketLibevent::SetMulticastOptions() {
   if (multicast_interface_ != 0) {
     switch (addr_family_) {
       case AF_INET: {
-#if !defined(OS_MACOSX)
+#if !defined(OS_MACOSX) && !defined(OS_BSD)
         ip_mreqn mreq;
         mreq.imr_ifindex = multicast_interface_;
         mreq.imr_address.s_addr = htonl(INADDR_ANY);
@@ -705,7 +705,7 @@ int UDPSocketLibevent::JoinGroup(const IPAddressNumber
       if (addr_family_ != AF_INET)
         return ERR_ADDRESS_INVALID;
 
-#if !defined(OS_MACOSX)
+#if !defined(OS_MACOSX) && !defined(OS_BSD)
       ip_mreqn mreq;
       mreq.imr_ifindex = multicast_interface_;
       mreq.imr_address.s_addr = htonl(INADDR_ANY);
